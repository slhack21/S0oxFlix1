<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>S0oxFlix</title>
  <style>
    :root {--bg:#0f0a1a;--p:#6a0dad;--a:#9d4edd;--t:#e0d4ff;--c:#1a1033;}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{background:var(--bg);color:var(--t);font-family:Arial;overflow-x:hidden;}
    header{background:var(--c);padding:1rem;position:sticky;top:0;z-index:100;box-shadow:0 2px 10px rgba(0,0,0,0.5);}
    .logo{font-size:2rem;color:var(--a);font-weight:bold;text-align:center;}
    .search input{width:90%;max-width:600px;margin:1rem auto;display:block;padding:1rem;border-radius:50px;background:var(--bg);color:var(--t);border:1px solid var(--a);outline:none;}
    .search input::placeholder{color:#999;}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem;padding:1rem;}
    .card{background:var(--c);border-radius:12px;overflow:hidden;cursor:pointer;transition:transform 0.2s ease;box-shadow:0 4px 8px rgba(0,0,0,0.3);}
    .card:hover{transform:scale(1.05);}
    .card img{width:100%;height:220px;object-fit:cover;}
    .card .title{padding:0.5rem;font-size:0.9rem;text-align:center;}
    .player{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:999;justify-content:center;align-items:center;padding:2rem;}
    .player.active{display:flex;}
    .video-container{width:90%;max-width:1000px;height:70vh;background:#000;border-radius:12px;overflow:hidden;box-shadow:0 8px 20px rgba(0,0,0,0.5);position:relative;}
    video{width:100%;height:100%;object-fit:contain;}
    .close{position:absolute;top:20px;right:20px;background:var(--p);color:#fff;border:none;width:50px;height:50px;border-radius:50%;font-size:1.5rem;cursor:pointer;z-index:10;}
    .close:hover{background:var(--a);}
    .controls{position:absolute;bottom:0;left:0;width:100%;background:linear-gradient(transparent, rgba(0,0,0,0.8));padding:1rem;color:#fff;display:flex;align-items:center;gap:1rem;}
    .play-btn{background:none;border:none;color:#fff;font-size:1.5rem;cursor:pointer;}
    .progress{flex:1;height:5px;background:#333;border-radius:5px;overflow:hidden;}
    .progress-bar{height:100%;background:var(--a);width:0%;}
    @media(max-width:768px){.video-container{width:100%;height:60vh;}}
  </style>
</head>
<body>

<header><div class="logo">S0oxFlix</div></header>

<input type="text" placeholder="Rechercher..." oninput="search(this.value)" class="search">

<div class="grid" id="grid">
  <!-- EXEMPLE : Interstellar (lien direct + magnet) -->
  <div class="card" data-src="https://archive.org/download/interstellar-2014-1080p/Interstellar.2014.1080p.BluRay.x264.YIFY.mp4" data-magnet="magnet:?xt=urn:btih:abc123&dn=Interstellar+2014+1080p" data-title="Interstellar">
    <img src="https://image.tmdb.org/t/p/w500/interstellar-poster.jpg" onerror="this.src='https://via.placeholder.com/150x220?text=Interstellar'">
    <div class="title">Interstellar</div>
  </div>
  <!-- Ajoute d'autres films avec data-src (lien direct) ou data-magnet -->
</div>

<div class="player" id="player">
  <button class="close" onclick="closePlayer()">X</button>
  <div class="video-container">
    <video id="video" controls autoplay></video>
    <div class="controls">
      <button class="play-btn" id="playPause">Play</button>
      <div class="progress"><div class="progress-bar" id="progress"></div></div>
      <span id="time">0:00 / 0:00</span>
    </div>
  </div>
</div>

<script>
  const video = document.getElementById('video');
  const playPause = document.getElementById('playPause');
  const progress = document.getElementById('progress');
  const time = document.getElementById('time');

  function play(src, magnet, title) {
    const player = document.getElementById('player');
    
    // Priorité : lien direct
    if (src) {
      video.src = src;
      video.load();
      player.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    // Sinon : magnet (ouvre dans client torrent)
    else if (magnet && confirm(`Ouvrir "${title}" dans ton client torrent ?`)) {
      window.location.href = magnet;
    }
  }

  function closePlayer() {
    const player = document.getElementById('player');
    player.classList.remove('active');
    video.pause();
    video.src = '';
    document.body.style.overflow = 'auto';
  }

  // Contrôles
  playPause.onclick = () => {
    if (video.paused) {
      video.play();
      playPause.textContent = 'Pause';
    } else {
      video.pause();
      playPause.textContent = 'Play';
    }
  };

  video.ontimeupdate = () => {
    const percent = (video.currentTime / video.duration) * 100;
    progress.style.width = percent + '%';
    time.textContent = formatTime(video.currentTime) + ' / ' + formatTime(video.duration);
  };

  function formatTime(seconds) {
    if (isNaN(seconds)) return '0:00';
    const m = Math.floor(seconds / 60);
    const s = Math.floor(seconds % 60);
    return `${m}:${s.toString().padStart(2, '0')}`;
  }

  function search(q) {
    const cards = document.querySelectorAll('.card');
    cards.forEach(c => {
      const title = c.querySelector('.title').textContent.toLowerCase();
      c.style.display = title.includes(q.toLowerCase()) ? 'block' : 'none';
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('click', () => {
        const src = card.dataset.src;
        const magnet = card.dataset.magnet;
        const title = card.dataset.title;
        play(src, magnet, title);
      });
    });
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') closePlayer();
    });
  });
</script>
</body>
</html>
