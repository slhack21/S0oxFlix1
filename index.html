<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>S0oxFlix</title>
  <link rel="manifest" href="data:application/manifest+json,{
    \"name\":\"S0oxFlix\",
    \"short_name\":\"S0ox\",
    \"start_url\":\".\",
    \"display\":\"standalone\",
    \"background_color\":\"#4a148c\",
    \"theme_color\":\"#6a1b9a\",
    \"icons\":[{\"src\":\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüé¨%3C/text%3E%3C/svg%3E\",\"sizes\":\"192x192\",\"type\":\"image/svg+xml\"}]
  }">
  <style>
    :root { --bg: #0f0a1a; --card: #1a0d33; --text: #e0d0ff; --accent: #6a1b9a; }
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:var(--bg); color:var(--text); font-family:'Arial'; text-align:center; }
    header { background:var(--accent); padding:15px; }
    h1 { font-size:1.8rem; }
    input { width:90%; max-width:500px; padding:12px; margin:15px; border-radius:8px; border:none; font-size:1rem; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(150px,1fr)); gap:15px; padding:20px; }
    .card { background:var(--card); border-radius:12px; overflow:hidden; cursor:pointer; transition:0.3s; }
    .card:hover { transform:scale(1.05); }
    .card img { width:100%; height:200px; object-fit:cover; }
    .info { padding:10px; }
    .info h3 { font-size:1rem; }
    video { width:100%; max-width:800px; margin:20px auto; display:block; border-radius:12px; }
    .popup { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:999; }
    .popup button { background:#6a1b9a; color:white; border:none; padding:15px 30px; margin:10px; border-radius:8px; font-size:1.2rem; cursor:pointer; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <header><h1>üé¨ S0oxFlix</h1></header>
  <input type="text" id="search" placeholder="üîç Rechercher un film..." onkeyup="filter()">
  <div class="grid" id="films"></div>
  <video id="player" controls class="hidden"></video>

  <!-- POPUP ADS -->
  <div id="adPopup" class="popup hidden">
    <p style="color:white; font-size:1.2rem;">‚ö†Ô∏è Une pub va s'ouvrir<br>Merci de ton soutien !</p>
    <button onclick="openAd()">Continuer</button>
  </div>
  <div id="thanksPopup" class="popup hidden">
    <p style="color:white; font-size:1.2rem;">‚ù§Ô∏è Merci pour ton soutien !<br>Bon film !</p>
    <button onclick="closeThanks()">Fermer</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script>
    const films = [
      {t:"Metropolis", y:1927, img:"https://archive.org/services/img/metropolis_1927", url:"https://archive.org/download/metropolis_1927/metropolis_1927_1080p.m3u8"},
      {t:"Nosferatu", y:1922, img:"https://archive.org/services/img/nosferatu_1922", url:"https://archive.org/download/nosferatu_1922/nosferatu.m3u8"},
      {t:"Night of the Living Dead", y:1968, img:"https://archive.org/services/img/night_of_the_living_dead", url:"https://archive.org/download/night_of_the_living_dead/night.m3u8"},
      {t:"The Kid", y:1921, img:"https://archive.org/services/img/the_kid_1921", url:"https://archive.org/download/the_kid_1921/the_kid.m3u8"}
      // +46 films dans la version finale
    ];

    function render() {
      const grid = document.getElementById('films');
      grid.innerHTML = '';
      films.forEach(f => {
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `<img src="${f.img}/format=jpg&height=200" alt="${f.t}">
          <div class="info"><h3>${f.t}</h3><p>${f.y}</p></div>`;
        card.onclick = () => showAd(f.url, f.t);
        grid.appendChild(card);
      });
    }

    function filter() {
      const term = document.getElementById('search').value.toLowerCase();
      const filtered = films.filter(f => f.t.toLowerCase().includes(term));
      const grid = document.getElementById('films'); grid.innerHTML = '';
      filtered.forEach(f => {
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `<img src="${f.img}/format=jpg&height=200" alt="${f.t}">
          <div class="info"><h3>${f.t}</h3><p>${f.y}</p></div>`;
        card.onclick = () => showAd(f.url, f.t);
        grid.appendChild(card);
      });
    }

    function showAd(url, title) {
      document.getElementById('adPopup').classList.remove('hidden');
      window.currentFilm = {url, title};
    }

    function openAd() {
      document.getElementById('adPopup').classList.add('hidden');
      
      // === TON ADSTERRA POPUNDER ===
      const adsterraScript = document.createElement('script');
      adsterraScript.src = '//pl27976969.effectivegatecpm.com/f1/f2/7c/f1f27c6bc9906eca8322aec126ded56b.js';
      document.head.appendChild(adsterraScript);
      
      setTimeout(() => {
        document.getElementById('thanksPopup').classList.remove('hidden');
      }, 2000);
    }

    function closeThanks() {
      document.getElementById('thanksPopup').classList.add('hidden');
      const {url, title} = window.currentFilm;
      const video = document.getElementById('player');
      video.classList.remove('hidden');
      if (Hls.isSupported() && url.includes('.m3u8')) {
        const hls = new Hls(); hls.loadSource(url); hls.attachMedia(video);
      } else { video.src = url; }
      video.play();
      document.querySelector('header h1').textContent = title;
    }

    render();
  </script>
</body>
</html>