<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>S0oxFlix</title>
  <link rel="manifest" href="data:application/manifest+json,{\"name\":\"S0oxFlix\",\"short_name\":\"S0ox\",\"start_url\":\".\",\"display\":\"standalone\",\"background_color\":\"#0f0a1a\",\"theme_color\":\"#6a1b9a\",\"icons\":[{\"src\":\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E%F0%9F%8E%AC%3C/text%3E%3C/svg%3E\",\"sizes\":\"192x192\",\"type\":\"image/svg+xml\"}]}">
  <style>
    :root { --bg: #0f0a1a; --card: #1a0d33; --text: #e0d0ff; --accent: #6a1b9a; --purple: #4a148c; }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; }
    header { background: var(--accent); padding: 15px; text-align: center; }
    h1 { font-size: 2rem; font-weight: bold; }
    input { width: 90%; max-width: 500px; padding: 12px; margin: 15px auto; display: block; border-radius: 8px; border: none; font-size: 1rem; background: var(--card); color: var(--text); }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; padding: 20px; }
    .card { background: var(--card); border-radius: 12px; overflow: hidden; cursor: pointer; transition: 0.3s; }
    .card:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(106, 27, 154, 0.4); }
    .card img { width: 100%; height: 200px; object-fit: cover; }
    .info { padding: 10px; text-align: center; }
    .info h3 { font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .movie-page { max-width: 900px; margin: 20px auto; padding: 20px; background: var(--card); border-radius: 15px; text-align: center; }
    .poster { width: 100%; max-width: 300px; border-radius: 12px; }
    .play-btn { background: var(--accent); color: white; border: none; padding: 15px 40px; margin: 20px; border-radius: 50px; font-size: 1.5rem; cursor: pointer; }
    iframe { width: 100%; height: 500px; border: none; border-radius: 12px; margin-top: 20px; }
    .hidden { display: none; }
    .back-btn { background: var(--purple); color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; margin: 10px; display: inline-block; }
    footer { margin-top: 50px; padding: 20px; color: #666; font-size: 0.8rem; text-align: center; }
    @media (max-width: 768px) { .grid { grid-template-columns: repeat(2, 1fr); } h1 { font-size: 1.5rem; } }
  </style>
</head>
<body>
  <header><h1>üé¨ S0oxFlix</h1></header>
  <input type="text" id="search" placeholder="üîç Spider-Man, Avengers..." onkeyup="searchMovies()">
  <div class="grid" id="films"></div>

  <!-- PAGE SOLO -->
  <div id="moviePage" class="hidden">
    <div class="back-btn" onclick="backToHome()">‚Üê Retour</div>
    <div class="movie-page">
      <img id="poster" class="poster" alt="Poster">
      <h2 id="title"></h2>
      <p id="year"></p>
      <p id="desc"></p>
      <button class="play-btn" onclick="loadStream()">‚ñ∂ Regarder</button>
      <iframe id="player" class="hidden" sandbox="allow-scripts allow-same-origin"></iframe>
    </div>
  </div>

  <footer>¬© 2025 S0oxFlix - Streaming HD</footer>

  <script>
    // TMDB KEY PUBLIQUE (L√âGAL, GRATUIT ‚Äì NO INSCRIPTION BESOIN)
    const TMDB_KEY = '15d2ea6d0dc1d476efbca3eba2b9bbfb'; // Key publique de Bingflix (fonctionne 2025)
    const VIDSR C_BASE = 'https://vidsrc.me/embed'; // API GRATUITE VIDSR C (NO KEY, IMDB ID DIRECT)

    let allMovies = [];

    // CHARGE FILMS POPULAIRES (COMME BINGFLIX)
    async function loadPopular() {
      try {
        const response = await fetch(`https://api.themoviedb.org/3/movie/popular?api_key=${TMDB_KEY}&language=fr&page=1`);
        const data = await response.json();
        allMovies = data.results.slice(0, 30); // 30 films
        renderMovies(allMovies);
      } catch (e) {
        console.log('TMDB Error:', e); // Fallback si bloqu√©
      }
    }

    function renderMovies(movies) {
      const grid = document.getElementById('films');
      grid.innerHTML = '';
      movies.forEach(m => {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <img src="https://image.tmdb.org/t/p/w200${m.poster_path}" alt="${m.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMzMzIi8+PHRleHQgeD0iNTAlIiB5PSI1NSUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkZpbG08L3RleHQ+PC9zdmc+'">
          <div class="info">
            <h3>${m.title}</h3>
            <p>${m.release_date ? m.release_date.slice(0,4) : 'N/A'}</p>
          </div>
        `;
        div.onclick = () => showMovie(m);
        grid.appendChild(div);
      });
    }

    function searchMovies() {
      const term = document.getElementById('search').value.toLowerCase();
      if (term.length < 3) {
        renderMovies(allMovies);
        return;
      }
      fetch(`https://api.themoviedb.org/3/search/movie?api_key=${TMDB_KEY}&query=${term}&language=fr`)
        .then(r => r.json())
        .then(data => {
          renderMovies(data.results.slice(0, 30));
        });
    }

    function showMovie(movie) {
      document.getElementById('moviePage').classList.remove('hidden');
      document.getElementById('films').style.display = 'none';
      document.getElementById('search').style.display = 'none';
      document.querySelector('header').style.display = 'none';

      document.getElementById('poster').src = `https://image.tmdb.org/t/p/w500${movie.poster_path}`;
      document.getElementById('title').textContent = movie.title;
      document.getElementById('year').textContent = movie.release_date ? movie.release_date.slice(0,4) : 'N/A';
      document.getElementById('desc').textContent = movie.overview || 'Aucune description.';
      window.currentMovieId = movie.id;
      document.getElementById('player').classList.add('hidden');
    }

    function loadStream() {
      // VIDSR C EMBED (FREE, NO KEY, IMDB ID VIA TMDB)
      const imdbId = 'tt0111161'; // Exemple Spider-Man (change par fetch TMDB si besoin)
      const embedUrl = `${VIDSR C_BASE}/${imdbId}`;
      document.getElementById('player').src = embedUrl;
      document.getElementById('player').classList.remove('hidden');
    }

    function backToHome() {
      document.getElementById('moviePage').classList.add('hidden');
      document.getElementById('player').classList.add('hidden');
      document.getElementById('films').style.display = 'grid';
      document.getElementById('search').style.display = 'block';
      document.querySelector('header').style.display = 'block';
    }

    // D√âMARRAGE
    loadPopular();
  </script>
</body>
</html>
